'use strict';

var WebSocket = require('ws');
var wsServer = 'ws://ruiramos.com:8990';
var ws;

function init() {
  ws = new WebSocket(wsServer);

  ws.on('open', function open() {
    // ?
    console.log('ws connection open!');
  });

  ws.on('close', function close() {
    console.log('disconnected');
    ws = new WebSocket(wsServer);
  });
}

function send(event) {
  if (ws.readyState === WebSocket.OPEN) {
    ws.send(JSON.stringify(event));
  } else {
    console.log('Trying to send a message but the ws died!');
  }
}

function onMessage(cb) {
  ws.on('message', cb);
}

module.exports = {
  init: init, onMessage: onMessage, send: send
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9zb2NrZXQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFDQSxJQUFJLFlBQVksUUFBUSxJQUFSLENBQWhCO0FBQ0EsSUFBSSxXQUFXLHdCQUFmO0FBQ0EsSUFBSSxFQUFKOztBQUVBLFNBQVMsSUFBVCxHQUFlO0FBQ2IsT0FBSyxJQUFJLFNBQUosQ0FBYyxRQUFkLENBQUw7O0FBRUEsS0FBRyxFQUFILENBQU0sTUFBTixFQUFjLFNBQVMsSUFBVCxHQUFnQjs7QUFFNUIsWUFBUSxHQUFSLENBQVkscUJBQVo7QUFDRCxHQUhEOztBQUtBLEtBQUcsRUFBSCxDQUFNLE9BQU4sRUFBZSxTQUFTLEtBQVQsR0FBaUI7QUFDOUIsWUFBUSxHQUFSLENBQVksY0FBWjtBQUNBLFNBQUssSUFBSSxTQUFKLENBQWMsUUFBZCxDQUFMO0FBQ0QsR0FIRDtBQUlEOztBQUVELFNBQVMsSUFBVCxDQUFjLEtBQWQsRUFBb0I7QUFDbEIsTUFBRyxHQUFHLFVBQUgsS0FBa0IsVUFBVSxJQUEvQixFQUFvQztBQUNsQyxPQUFHLElBQUgsQ0FBUSxLQUFLLFNBQUwsQ0FBZSxLQUFmLENBQVI7QUFDRCxHQUZELE1BRU87QUFDTCxZQUFRLEdBQVIsQ0FBWSwyQ0FBWjtBQUNEO0FBQ0Y7O0FBRUQsU0FBUyxTQUFULENBQW1CLEVBQW5CLEVBQXNCO0FBQ3BCLEtBQUcsRUFBSCxDQUFNLFNBQU4sRUFBaUIsRUFBakI7QUFDRDs7QUFFRCxPQUFPLE9BQVAsR0FBaUI7QUFDZixZQURlLEVBQ1Qsb0JBRFMsRUFDRTtBQURGLENBQWpCIiwiZmlsZSI6InNvY2tldC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxudmFyIFdlYlNvY2tldCA9IHJlcXVpcmUoJ3dzJyk7XG52YXIgd3NTZXJ2ZXIgPSAnd3M6Ly9ydWlyYW1vcy5jb206ODk5MCdcbnZhciB3cztcblxuZnVuY3Rpb24gaW5pdCgpe1xuICB3cyA9IG5ldyBXZWJTb2NrZXQod3NTZXJ2ZXIpO1xuXG4gIHdzLm9uKCdvcGVuJywgZnVuY3Rpb24gb3BlbigpIHtcbiAgICAvLyA/XG4gICAgY29uc29sZS5sb2coJ3dzIGNvbm5lY3Rpb24gb3BlbiEnKVxuICB9KTtcblxuICB3cy5vbignY2xvc2UnLCBmdW5jdGlvbiBjbG9zZSgpIHtcbiAgICBjb25zb2xlLmxvZygnZGlzY29ubmVjdGVkJyk7XG4gICAgd3MgPSBuZXcgV2ViU29ja2V0KHdzU2VydmVyKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHNlbmQoZXZlbnQpe1xuICBpZih3cy5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuT1BFTil7XG4gICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeShldmVudCkpO1xuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUubG9nKCdUcnlpbmcgdG8gc2VuZCBhIG1lc3NhZ2UgYnV0IHRoZSB3cyBkaWVkIScpXG4gIH1cbn1cblxuZnVuY3Rpb24gb25NZXNzYWdlKGNiKXtcbiAgd3Mub24oJ21lc3NhZ2UnLCBjYik7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBpbml0LCBvbk1lc3NhZ2UsIHNlbmRcbn1cbiJdfQ==