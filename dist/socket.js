'use strict';

var WebSocket = require('ws');
var wsServer = 'ws://172.16.40.132:8990';
var ws;

function init() {
  ws = new WebSocket(wsServer);

  ws.on('open', function open() {
    // ?
    console.log('ws connection open!');
  });

  ws.on('close', function close() {
    console.log('disconnected');
    ws = new WebSocket(wsServer);
  });
}

function send(event) {
  if (ws.readyState === WebSocket.OPEN) {
    ws.send(JSON.stringify(event));
  } else {
    console.log('Trying to send a message but the ws died!');
  }
}

function onMessage(cb) {
  ws.on('message', cb);
}

module.exports = {
  init: init, onMessage: onMessage, send: send
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9zb2NrZXQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFDQSxJQUFJLFlBQVksUUFBUSxJQUFSLENBQWhCO0FBQ0EsSUFBSSxXQUFXLHlCQUFmO0FBQ0EsSUFBSSxFQUFKOztBQUVBLFNBQVMsSUFBVCxHQUFlO0FBQ2IsT0FBSyxJQUFJLFNBQUosQ0FBYyxRQUFkLENBQUw7O0FBRUEsS0FBRyxFQUFILENBQU0sTUFBTixFQUFjLFNBQVMsSUFBVCxHQUFnQjs7QUFFNUIsWUFBUSxHQUFSLENBQVkscUJBQVo7QUFDRCxHQUhEOztBQUtBLEtBQUcsRUFBSCxDQUFNLE9BQU4sRUFBZSxTQUFTLEtBQVQsR0FBaUI7QUFDOUIsWUFBUSxHQUFSLENBQVksY0FBWjtBQUNBLFNBQUssSUFBSSxTQUFKLENBQWMsUUFBZCxDQUFMO0FBQ0QsR0FIRDtBQUlEOztBQUVELFNBQVMsSUFBVCxDQUFjLEtBQWQsRUFBb0I7QUFDbEIsTUFBRyxHQUFHLFVBQUgsS0FBa0IsVUFBVSxJQUEvQixFQUFvQztBQUNsQyxPQUFHLElBQUgsQ0FBUSxLQUFLLFNBQUwsQ0FBZSxLQUFmLENBQVI7QUFDRCxHQUZELE1BRU87QUFDTCxZQUFRLEdBQVIsQ0FBWSwyQ0FBWjtBQUNEO0FBQ0Y7O0FBRUQsU0FBUyxTQUFULENBQW1CLEVBQW5CLEVBQXNCO0FBQ3BCLEtBQUcsRUFBSCxDQUFNLFNBQU4sRUFBaUIsRUFBakI7QUFDRDs7QUFFRCxPQUFPLE9BQVAsR0FBaUI7QUFDZixZQURlLEVBQ1Qsb0JBRFMsRUFDRTtBQURGLENBQWpCIiwiZmlsZSI6InNvY2tldC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxudmFyIFdlYlNvY2tldCA9IHJlcXVpcmUoJ3dzJyk7XG52YXIgd3NTZXJ2ZXIgPSAnd3M6Ly8xNzIuMTYuNDAuMTMyOjg5OTAnXG52YXIgd3M7XG5cbmZ1bmN0aW9uIGluaXQoKXtcbiAgd3MgPSBuZXcgV2ViU29ja2V0KHdzU2VydmVyKTtcblxuICB3cy5vbignb3BlbicsIGZ1bmN0aW9uIG9wZW4oKSB7XG4gICAgLy8gP1xuICAgIGNvbnNvbGUubG9nKCd3cyBjb25uZWN0aW9uIG9wZW4hJylcbiAgfSk7XG5cbiAgd3Mub24oJ2Nsb3NlJywgZnVuY3Rpb24gY2xvc2UoKSB7XG4gICAgY29uc29sZS5sb2coJ2Rpc2Nvbm5lY3RlZCcpO1xuICAgIHdzID0gbmV3IFdlYlNvY2tldCh3c1NlcnZlcik7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBzZW5kKGV2ZW50KXtcbiAgaWYod3MucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0Lk9QRU4pe1xuICAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoZXZlbnQpKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmxvZygnVHJ5aW5nIHRvIHNlbmQgYSBtZXNzYWdlIGJ1dCB0aGUgd3MgZGllZCEnKVxuICB9XG59XG5cbmZ1bmN0aW9uIG9uTWVzc2FnZShjYil7XG4gIHdzLm9uKCdtZXNzYWdlJywgY2IpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgaW5pdCwgb25NZXNzYWdlLCBzZW5kXG59Il19